# EntityFramework
Работа с EntityFramework.
### Project CRUD:
CRUD — акроним, обозначающий четыре базовые функции, используемые при работе с базами данных: создание, чтение, модификация, удаление.
### Project Cascading Delete:
Каскадное удаление представляет автоматическое удаление зависимой сущности после удаления главной в базах данных.
### Project Complex Types:
Создание сложного типа (таблици).
### Project Connection Сonfiguration:
Настройка конфигурации подлючения EntityFramework6.
### Project Creating Models:
Добовление новых моделив в базу даных.
### Project Database Management:
Работа с миграцией базы данных с помощью EntityFramework6.
### Project Database Schema Management AndMigration:
Управление схемой базы данных и миграция EntityFramework6.
### Project Generating Property And Column Values:
Если при добавлении или обновлении нового объекта у него уже установлено значение для свойства, Entity Framework использует это значение при вставке или обновлении в таблицу. Если для свойства явным образом не установлено значение, то для свойства устанавливается значение по умолчанию (null для nullable-типов, 0 для int, Guid.Empty для Guid и т.д.).
В зависимости от используемого провайдера базы данных, значения для свойств могут генерироваться на стороне клиента с помощью EF, либо же генерироваться уже на стороне базы данных при добавлении. Если значение генерируется базой данных, тогда при добавлении объекта в контекст EF может назначить временное значение. Это временное значение будет заменено значением, сгенерированным базой данных при вызове метода SaveChanges().
### Project LINQ to Entities:
Введение в LINQ to Entities. Для извлечения данных из базы данных Entity Framework Core использует технологию LINQ to Entities. В основе данной технологии лежит язык интегрированных запросов LINQ (Language Integrated Query). LINQ предлагает простой и интуитивно понятный подход для получения данных с помощью выражений, которые по форме близки выражениям языка SQL.
Хотя при работе с базой данных мы оперируем запросами LINQ, но, реляционные базы данных как MS SQL Server или SQLite, понимают только запросы на языке SQL. Поэтому Entity Framework Core, используя выражения LINQ to Entities, транслирует их в определенные запросы, понятные для используемого источника данных.
### Project Explicit loading:
Стратегия Explicit loading предполагает явную загрузку данных с помощью метода Load(). Допустим, у нас имеются следующие сущности и контекст данных.
### Project Lazy Loading:
Lazy loading или ленивая загрузка предполагает неявную автоматическую загрузку связанных данных при обращении к навигационному свойству. Однако здесь есть ряд условий:
При конфигурации контекста данных вызвать метод UseLazyLoadingProxies().
Все навигационные свойства должны быть определены как виртуальные (то есть с модификатором virtual), при этом сами классы моделей должны быть открыты для наследования
Используем lazy loading. Прежде всего добавим в проект через nuget пакет Microsoft.EntityFrameworkCore.Proxies.
### Project Loading Related Data Method Include:
Через навигационные свойства мы можем загружать связанные данные. И здесь у нас три стратегии загрузки:
Eager loading (жадная загрузка)
Explicit loading (явная загрузка)
Lazy loading (ленивая загрузка)
В начале рассмотрим, что предствляет собой eager loading или жадная загрузка. Она позволяет загружать связанные данные с помощью метода Include(), в который передается навигационное свойство.
### Project Logging Operations:
Логгирование позволяет нам получить информацию о выполняемых в Entity Framework операциях. Причем использовать как встроенные возможности, так и создать и встроить свою инфраструктуру логгирования. Рассмотрим оба варианта и начнем со встроенных возможностей.
### Project Many To Many Relationship:
Отношение многие-ко-многим (many-to-many) представляет связь, при которой объект одной сущности может ссылаться на множество объектов второй сущности, а объект второй сущности, в свою очередь, может ссылаться на множество объектов первой сущности. Примером подобного отношения может служить посещение студентами университетских курсов. Один студент может посещать сразу несколько курсов, и, в свою очередь, один курс может посещаться множеством студентов.
### Project Model Configuration:
Конфигурачия можелий , базы данных , EFcore
### Project Object Tracking And AsNoTracking:
Запросы могут быть отслеживаемыми и неотслеживаемыми. По умолчанию все запросы, которые возвращают объекты классов моделей являются отслеживаемыми. Когда контекст данных извлекает данные из базы данных, Entity Framework Core помещает извлеченные объекты в кэш и отслеживает изменения, которые происходят с этими объектами вплоть до использования метода SaveChanges()/SaveChangesAsync(), который фиксирует все изменения в базе данных. Но нам не всегда необходимо отслеживать изменения. Например, нам надо просто вывести данные для просмотра.
Чтобы данные не помещались в кэш, применяется метод AsNoTracking(). Этот метод применяется к объекту IQueryable. При его применении возвращаемые из запроса данные не кэшируются. То есть запрос является неотслеживаемым. А это означает, что Entity Framework Core не производит какую-то дополнительную обработку и не выделяет дополнительное место для хранения извлеченных из БД объектов. И поэтому такие запросы работают быстрее.
### Project One To Many Relationship:
Отношение один-ко-многим (one-to-many) представляет ситуацию, когда одна сущность хранит ссылку на один объект другой сущности, а вторая сущность может ссылаться на коллекцию объектов первой сущности. Например, в одной компании может работать несколько сотрудников, а каждый сотрудник в свою очередь может официально работать только в одной компании.
### Project One To One Relationship:
Отношение один к одному предполагает, что главная сущность может ссылаться только на один объект зависимой сущности. В свою очередь, зависимая сущность может ссылаться только на один объект главной сущности.
### Project Relationships Betwe Entities:
Для связей между сущностями в Entity Framework Core применяются внешние ключи и навигационные свойства. Так, возьмем к примеру следующие сущности в проекте RelationshipsBetweEntities
### Project SQL in Entity Framework Core:
Кроме использования инфраструктуры LINQ to Entities для создания запросов Entity Framework Core также позволяет писать запросы к базе данных сразу на языке SQL. Это может быть удобно, если запрос очень сложный по своей структуре или если Entity Framework Core на основе Linq to Entities создает не очень оптимальный sql-запрос.
### Project TPH_Table Per Hierarchy: Паттерн
По умолчанию при работе с цепочками наследования классов Entity Framework Core использует подход TPH (Table Per Hierarchy / Таблица на одну иерархию классов). При использовании данного подхода TPH для всех классов из одной иерархии в базе данных создается одна таблица. А чтобы определить, к какому именно классу относится строка в таблице, в этой же таблице создается дополнительный столбец - дискриминатор.
### Project TPT_Table Per Type: Паттерн
EntityFramework Core позволяет использовать другой подход - TPT или Table Per Type, который предполагает создание отдельной таблицы для каждого класса из иерархии. Для реализации подхода TPT можно использовать два способа: атрибуты или Fluent API.
